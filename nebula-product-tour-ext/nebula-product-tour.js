define(["qlik","translator","./dist/nebula-product-tour","./nlib/@nebula.js/stardust/dist/stardust"],(function(e,t,n,i){"use strict";function s(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=s(e),r=s(t),a=s(n),c={type:"items",component:"expandable-items",translation:"properties.addons",items:{dataHandling:{uses:"dataHandling",items:{suppressZero:null,calcCond:{uses:"calcCond"}}}}};const l=1;function h(e,t){const n=[];return function(e){return!!e.tooltips||e.interactionState===l&&!1!==e.tooltips}(e)&&n.push("passive"),e.interactionState===l&&!1!==e.tooltips&&!0!==e.limitedInteraction&&n.push("interact"),t.isSnapshot||(!1!==e.selections&&n.push("select"),n.push("fetch")),n}var p={};function d(){d.init.call(this)}p.isObject=function(e){return"object"==typeof e&&null!==e},p.isNumber=function(e){return"number"==typeof e},p.isUndefined=function(e){return void 0===e},p.isFunction=function(e){return"function"==typeof e};var u=d;d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},d.prototype.setMaxListeners=function(e){if(!p.isNumber(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},d.prototype.emit=function(e){var t,n,i,s,o,r;if(this._events||(this._events={}),"error"===e&&!this._events.error)throw(t=arguments[1])instanceof Error?t:Error('Uncaught, unspecified "error" event.');if(n=this._events[e],p.isUndefined(n))return!1;if(p.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,s=new Array(i-1),o=1;o<i;o++)s[o-1]=arguments[o];n.apply(this,s)}else if(p.isObject(n)){for(i=arguments.length,s=new Array(i-1),o=1;o<i;o++)s[o-1]=arguments[o];for(i=(r=n.slice()).length,o=0;o<i;o++)r[o].apply(this,s)}return!0},d.prototype.addListener=function(e,t){var n;if(!p.isFunction(t))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,p.isFunction(t.listener)?t.listener:t),this._events[e]?p.isObject(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,p.isObject(this._events[e])&&!this._events[e].warned)&&((n=p.isUndefined(this._maxListeners)?d.defaultMaxListeners:this._maxListeners)&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,p.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),p.isFunction(console.trace)&&console.trace()));return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(e,t){if(!p.isFunction(t))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(e,i),n||(n=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},d.prototype.removeListener=function(e,t){var n,i,s,o;if(!p.isFunction(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,i=-1,n===t||p.isFunction(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(p.isObject(n)){for(o=s;o-- >0;)if(n[o]===t||n[o].listener&&n[o].listener===t){i=o;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},d.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[e],p.isFunction(n))this.removeListener(e,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},d.prototype.listeners=function(e){return this._events&&this._events[e]?p.isFunction(this._events[e])?[this._events[e]]:this._events[e].slice():[]},d.listenerCount=function(e,t){return e._events&&e._events[t]?p.isFunction(e._events[t])?1:e._events[t].length:0};var m=e=>{const t={begin(){e.selectionsApi.activated(),e.backendApi.beginSelections(),t.emit("activated")},clear(){e.backendApi.model.resetMadeSelections()},confirm(){e.selectionsApi.confirm()},cancel(){e.selectionsApi.cancel()},select(t){e.selectionsApi.active||e.backendApi.beginSelections(),e.backendApi.model[t.method](...t.params).then((t=>{t||(e.selectionsApi.selectionsMade=!1,this.clear())})),e.selectionsApi.selectionsMade="resetMadeSelections"!==t.method},isActive:()=>e.selectionsApi.active,refreshToolbar(){e.selectionsApi.refreshToolbar()}};var n;return n=t,Object.keys(u.prototype).forEach((e=>{n[e]=u.prototype[e]})),u.init(n),e.selectionsApi.confirm=()=>{e.backendApi.endSelections(!0).then((()=>{e.selectionsApi.deactivated(),t.emit("deactivated")}))},e.selectionsApi.clear=()=>{e.backendApi.clearSelections(),e.selectionsApi.selectionsMade=!1,t.emit("cleared")},e.selectionsApi.cancel=()=>{e.backendApi.endSelections(!1),e.selectionsApi.deactivated(),t.emit("canceled")},t};const{generator:v,theme:f,locale:g}=i.__DO_NOT_USE__,b=g({initial:r.default.language}),_={translator:{...b.translator,get(e,t){const n=r.default.get(e,t);return n===e?b.translator.get(e,t):n}},flags:{isEnabled:()=>!1},anything:{}},y=["viewState","direction","renderer"];function A(e,t){const n={};let i=!1;return Object.keys(e).forEach((s=>{-1!==y.indexOf(s)&&(n[s]=e[s],t[s]!==e[s]&&(i=!0))})),i?n:t}function L(e){return o.default.currApp(e).theme.getApplied().then((t=>{e.nTheme.externalAPI.name()!==t.id&&e.nTheme.internalAPI.setTheme(t.properties,t.id)}))}const x=v(a.default,_),w=function(){return{definition:{type:"items",component:"accordion",items:{data:{uses:"data"},sorting:{uses:"sorting"},addons:c,settings:{uses:"settings",items:{totals:{ref:"totals.show",type:"boolean",translation:"properties.totals",component:"switch",options:[{value:!0,translation:"Common.Auto"},{value:!1,translation:"Common.Custom"}],defaultValue:!0}}}}}}}||{};let k;if(x.qae.data.targets[0]){const e=x.qae.data.targets[0],t=e=>({...e,add:e.added,remove:e.removed,replace:e.replaced,move:e.moved});k={},e.dimensions&&(k.dimensions=t(e.dimensions)),e.measures&&(k.measures=t(e.measures))}return{definition:{type:"items",component:"accordion",items:{data:k?{uses:"data"}:void 0,sorting:k?{uses:"sorting"}:void 0,settings:{uses:"settings"}}},data:k,getSelectionToolbar(){return[...this.senseItems,{name:"Tooltip.clearSelection",tid:"selection-toolbar.clear",isIcon:!0,buttonClass:"clear",iconClass:"lui-icon lui-icon--clear-selections",action:function(){this.selectionsApi.clear()},isDisabled:function(){return!this.selectionsApi.selectionsMade}}]},...w,initialProperties:x.qae.properties.initial,template:'<div style="height: 100%;position: relative"></div>',mounted(e){const t=e[0].children[0],n=m(this.$scope),i=x.create({model:this.backendApi.model,app:this.backendApi.model.session.app,selections:n,explicitResize:!0});this.sn=i,this.snComponent=i.component,this.snComponent.created(),this.snComponent.mounted(t),this.senseItems=[];const{senseItems:s}=this;this.snComponent.observeActions((e=>{s.length=0,s.push(...function(e){return e.map((e=>{const t={isIcon:!0,buttonClass:"sel-toolbar-icon-toggle",isActive:()=>e.active,isDisabled:()=>e.disabled,action(){e.action()},getSvgIcon(){const t=e.getSvgIconShape(),{viewBox:n="0 0 16 16"}=t;return`<i style="display:inline-block;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-.2em;text-rendering:optimizeLegibility;web-kit-font-smoothing:antialiased;moz-osx-font-smoothing:grayscale"><svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="${n}" fill="currentColor">${t.shapes.map((({type:e,attrs:t})=>`<${e} ${Object.keys(t).map((e=>`${e}="${t[e]}"`)).join(" ")}/>`)).join("")}</svg></i>`}};return Object.defineProperties(t,{name:{get:()=>e.label},hidden:{get:()=>e.hidden}}),t}))}(e)),this.$scope.selectionsApi.refreshToolbar()})),this.nTheme=f(),this.initiatedTheme=L(this)},suppressOnPaint:()=>!1,paint(){const e=h(this.options,this.backendApi),t={passive:-1===e.indexOf("passive")||void 0,active:-1===e.indexOf("interact")||void 0,select:-1===e.indexOf("select")||void 0},n=A(this.options,this.snComponent.context.options);return this._pureLayout=this.backendApi.model.pureLayout||this.backendApi.model.layout,this.initiatedTheme.then((()=>(L(this),this.snComponent.render({layout:this.backendApi.model.pureLayout||this.backendApi.model.layout,context:{appLayout:{qLocaleInfo:this.backendApi.localeInfo},constraints:t,theme:this.nTheme.externalAPI},options:n}))))},resize(){if(this._pureLayout!==this.backendApi.model.pureLayout)return this.paint();const e=A(this.options,this.snComponent.context.options);return this.snComponent.context.options=e,this.snComponent.resize()},setInteractionState(){this.paint()},setSnapshotData(e){return this.snComponent.setSnapshotData(e)},getViewState(){const e=this.snComponent.getImperativeHandle();if(e&&"function"==typeof e.getViewState)return e.getViewState()},destroy(){this.sn.destroy(),this.snComponent&&(this.snComponent.willUnmount(),this.snComponent.destroy())}}}));
